<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Formulário de Cadastro de Cliente</title>

  <style>
    body {
      font-family: Arial, sans-serif;
    }

    .form-container {
      width: 500px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f5f5f5;
      border-radius: 5px;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }

    .form-field {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }

    .form-field label {
      width: 120px;
      margin-right: 10px;
      text-align: right;
    }

    .form-field input[type="email"],
    .form-field select,
    .form-field textarea {
      width: 300px;
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    .form-field input[type="text"],
    .form-field select,
    .form-field textarea {
      width: 300px;
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    .form-field input[type="submit"] {
      padding: 10px 20px;
      font-weight: bold;
      background-color: #4CAF50;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .form-field input.error {
      border: 3px solid red;
    }

    .form-field .error-message {
      color: red;
    }
    
    .button {
      display: inline-block;
      margin: 10px;
      padding: 10px 20px;
      background-color: #4286f4;
      color: #ffffff;
      text-decoration: none;
      border-radius: 5px;
    }
  </style>

  <script>
    // Função para voltar à página anterior
    function PagAnterior() {
      window.history.back();
    }
    function formatarLETRAS(input) {
      var valor = input.value
      valor = valor.replace(/[^a-zA-ZÀ-ÿ\s]+/, '');
      input.value = valor
    }

    function formatarNUMEROS(input) {
      var valor = input.value
      valor = valor.replace(/[^0-9]/g, '');
      input.value = valor
    }

    function formatarCEP(cep) {
      var valor = cep.value;
      valor = valor.replace(/\D/g, '');
      valor = valor.replace(/(\d{5})(\d{1,3})$/, '$1-$2');
      cep.value = valor
    }

    function formatarCPF(cpf) {
      var valor = cpf.value;
      valor = valor.replace(/\D/g, '');
      valor = valor.replace(/(\d{3})(\d)/, '$1.$2');
      valor = valor.replace(/(\d{3})(\d)/, '$1.$2');
      valor = valor.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
      cpf.value = valor;
    }

    function formatarCNPJ(cnpj) {
      var valor = cnpj.value;
      valor = valor.replace(/\D/g, '');
      valor = valor.replace(/^(\d{2})(\d)/, '$1.$2');
      valor = valor.replace(/^(\d{2})\.(\d{3})(\d)/, '$1.$2.$3');
      valor = valor.replace(/\.(\d{3})(\d)/, '.$1/$2');
      valor = valor.replace(/(\d{4})(\d)/, '$1-$2');
      cnpj.value = valor;
    }
    
    function formatarTELEFONE(input) {
      var valor = input.value;
      valor = valor.replace(/\D/g, '');
      valor = valor.replace(/(\d{2})(\d{1})(\d{4})(\d{4})$/, '($1) $2$3-$4');
      input.value = valor;
    }

    function validarFormulario() {
      var tipoPessoa = document.getElementById("tipo-pessoa").value;

      var telefone1 = document.getElementById('telefone1');
      var telefone2 = document.getElementById('telefone2');
      var email = document.getElementById('email');

      var uf = document.getElementById('uf');
      var cidade = document.getElementById('cidade');
      var bairro = document.getElementById('bairro');
      var rua = document.getElementById('rua');
      var numero = document.getElementById('numero');
      var complemento = document.getElementById('complemento');
      var cep = document.getElementById('cep');
      var valid = true;

      if (tipoPessoa == "pessoa-fisica") {
        var nome = document.getElementById('nome');
        var apelido = document.getElementById('apelido');
        var cpf = document.getElementById('cpf');
        var rg = document.getElementById('rg');

        if (!/^[a-zA-ZÀ-ÿ\s]+$/.test(nome.value)) {
          nome.classList.add('error');
          valid = false;
          } else {
          nome.classList.remove('error');
          }
    
        if (!/^[a-zA-ZÀ-ÿ\s]+$/.test(apelido.value)) {
          apelido.classList.add('error');
          valid = false;
          } else {
          apelido.classList.remove('error');
          }

        if (!/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(cpf.value)) {
          cpf.classList.add('error');
          valid = false;
          } else {
          cpf.classList.remove('error');
          }

        if (!/^\d{7,10}$/.test(rg.value)) {
          rg.classList.add('error');
          valid = false;
          } else {
          rg.classList.remove('error');
          }

      } else if (tipoPessoa == "pessoa-juridica") {
        var razaosocial = document.getElementById('razaosocial');
        var nomefantasia = document.getElementById('nomefantasia');
        var cnpj = document.getElementById('cnpj');
        var ie = document.getElementById('ie');

      if (!/^[a-zA-ZÀ-ÿ0-9\s]+$/.test(razaosocial.value)) {
        razaosocial.classList.add('error');
        valid = false;
        } else {
        razaosocial.classList.remove('error');
        }
    
      if (!/^[a-zA-ZÀ-ÿ0-9\s]+$/.test(nomefantasia.value)) {
        nomefantasia.classList.add('error');
        valid = false;
        } else {
        nomefantasia.classList.remove('error');
        }
    
      if (!/^\d{2}\.\d{3}\.\d{3}\/\d{4}\-\d{2}$/.test(cnpj.value)) {
        cnpj.classList.add('error');
        valid = false;
        } else {
        cnpj.classList.remove('error');
        }

      if (!/^\d{2,14}$/.test(ie.value)) {
        ie.classList.add('error');
        valid = false;
        } else {
        ie.classList.remove('error');
        }
      }
      
      if (!/\(\d{2}\) \d{5}-\d{4}/.test(telefone1.value)) {
        telefone1.classList.add('error');
        valid = false;
        } else {
        telefone1.classList.remove('error');
      }

      if (telefone2.value && !/\(\d{2}\) \d{5}-\d{4}/.test(telefone2.value)) {
        telefone2.classList.add('error');
        valid = false;
        } else {
        telefone2.classList.remove('error');
      }

      if (!/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}/.test(email.value)) {
        email.classList.add('error');
        valid = false;
        } else {
        email.classList.remove('error');
      }

      if (!/^[a-zA-ZÀ-ÿ\s]+$/.test(cidade.value)) {
        cidade.classList.add('error');
        valid = false;
        } else {
        cidade.classList.remove('error');
      }

      if (!/^[a-zA-ZÀ-ÿ\s]+$/.test(bairro.value)) {
        bairro.classList.add('error');
        valid = false;
        } else {
          bairro.classList.remove('error');
      }

      if (!/^[a-zA-ZÀ-ÿ\s]+$/.test(rua.value)) {
        rua.classList.add('error');
        valid = false;
        } else {
          rua.classList.remove('error');
      }

      if (!/^\d{1,5}$/.test(numero.value)) {
        numero.classList.add('error');
        valid = false;
        } else {
        numero.classList.remove('error');
      }

      if (!/^\d{5}-\d{3}$/.test(cep.value)) {
        cep.classList.add('error');
        valid = false;
        } else {
        cep.classList.remove('error');
      }

      if (valid) {
        alert('Cliente cadastrado com sucesso!');
        return true;
        } else {
        return false;
      }
    }

    function mostrarCampos(tipo) {
      var camposPessoaFisica = document.getElementById('campos-pessoa-fisica');
      var camposPessoaJuridica = document.getElementById('campos-pessoa-juridica');

      if (tipo === "pessoa-fisica") {
        camposPessoaFisica.style.display = 'block';
        camposPessoaJuridica.style.display = 'none';
      } else if (tipo === "pessoa-juridica") {
        camposPessoaFisica.style.display = 'none';
        camposPessoaJuridica.style.display = 'block';
      } else {
        camposPessoaFisica.style.display = 'none';
        camposPessoaJuridica.style.display = 'none';
      }
    }
  </script>

</head>

<body>
  <div class="form-container">
    <h4>Início > Clientes > Cadastrar novo cliente</h4>
    <h2>Formulário de Cadastro de Cliente</h2>

    <div>
      <button class="button" onclick="PagAnterior()">Voltar</button>
    </div>
    
    <form action="{% url 'cadastro_cliente' %}" method="POST" onsubmit="return validarFormulario()">{% csrf_token %}
      <h3>Identificação</h3>
      <div class="form-field">
        <label for="tipo-pessoa">Cliente:</label>
        <select id="tipo-pessoa" name="tipo-pessoa" onchange="mostrarCampos(this.value)">
          <option value="" disabled selected>Selecione o tipo...</option>
          <option value="pessoa-fisica">Pessoa Física</option>
          <option value="pessoa-juridica">Pessoa Jurídica</option>
        </select>
      </div>
      <div id="campos-pessoa-fisica" style="display: none;">
        <div class="form-field">
          <label for="nome">Nome:</label>
          <input type="text" id="nome" name="nome" pattern="[A-Za-zÀ-ú\s]+" oninput="formatarLETRAS(this)">
        </div>
        <div class="form-field">
          <label for="apelido">Apelido:</label>
          <input type="text" id="apelido" name="apelido" pattern="[A-Za-zÀ-ú\s]+">
        </div>
        <div class="form-field">
          <label for="cpf">CPF:</label>
          <input type="text" id="cpf" name="cpf" pattern="\d{3}\.\d{3}\.\d{3}-\d{2}" maxlength="14" oninput="formatarCPF(this)">
        </div>
        <div class="form-field">
          <label for="rg">RG:</label>
          <input type="text" id="rg" name="rg" pattern="\d{7,10}" maxlength="10" oninput="formatarNUMEROS(this)">
        </div>
      </div>
      <div id="campos-pessoa-juridica" style="display: none;">
        <div class="form-field">
          <label for="razaosocial">Razão Social:</label>
          <input type="text" id="razaosocial" name="razaosocial" pattern="[a-zA-ZÀ-ÿ0-9\s]+">
        </div>
        <div class="form-field">
          <label for="nomefantasia">Nome Fantasia:</label>
          <input type="text" id="nomefantasia" name="nomefantasia" pattern="[a-zA-ZÀ-ÿ0-9\s]+">
        </div>
        <div class="form-field">
          <label for="cnpj">CNPJ:</label>
          <input type="text" id="cnpj" name="cnpj" pattern="\d{2}\.\d{3}\.\d{3}\/\d{4}\-\d{2}" maxlength="18" oninput="formatarCNPJ(this)">
        </div>
        <div class="form-field">
          <label for="ie">IE:</label>
          <input type="text" id="ie" name="ie" pattern="[0-9]{2,14}" maxlength="14" oninput="formatarNUMEROS(this)">
        </div>
      </div>
      <h3>Contato</h3>
      <div class="form-field">
        <label for="telefone1">Telefone 1:</label>
        <input type="text" id="telefone1" name="telefone1" pattern="\([0-9]{2}\) [0-9]{5}-[0-9]{4}" oninput="formatarTELEFONE(this)" maxlength="15">
      </div>
      <div class="form-field">
        <label for="telefone2">Telefone 2:</label>
        <input type="text" id="telefone2" name="telefone2" pattern="\([0-9]{2}\) [0-9]{5}-[0-9]{4}" oninput="formatarTELEFONE(this)" maxlength="15">
      </div>
      <div class="form-field">
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}">
      </div>
      <h3>Endereço</h3>
      <div class="form-field">
        <label for="cep">CEP:</label>
        <input type="text" id="cep" name="cep" pattern="\d{5}-\d{3}" maxlength="9" oninput="formatarCEP(this)">
      </div>
      <div class="form-field">
        <label for="uf">UF:</label>
        <select id="uf" name="uf">
          <option value="" disabled selected>Selecione o estado...</option>
          <option value="AC">Acre</option>
          <option value="AL">Alagoas</option>
          <option value="AP">Amapá</option>
          <option value="AM">Amazonas</option>
          <option value="BA">Bahia</option>
          <option value="CE">Ceará</option>
          <option value="DF">Distrito Federal</option>
          <option value="ES">Espírito Santo</option>
          <option value="GO">Goiás</option>
          <option value="MA">Maranhão</option>
          <option value="MT">Mato Grosso</option>
          <option value="MS">Mato Grosso do Sul</option>
          <option value="MG">Minas Gerais</option>
          <option value="PA">Pará</option>
          <option value="PB">Paraíba</option>
          <option value="PR">Paraná</option>
          <option value="PE">Pernambuco</option>
          <option value="PI">Piauí</option>
          <option value="RJ">Rio de Janeiro</option>
          <option value="RN">Rio Grande do Norte</option>
          <option value="RS">Rio Grande do Sul</option>
          <option value="RO">Rondônia</option>
          <option value="RR">Roraima</option>
          <option value="SC">Santa Catarina</option>
          <option value="SP">São Paulo</option>
          <option value="SE">Sergipe</option>
          <option value="TO">Tocantins</option>
        </select>
      </div>
      <div class="form-field">
        <label for="cidade">Cidade:</label>
        <input type="text" id="cidade" name="cidade" pattern="[A-Za-zÀ-ú\s]+" oninput="formatarLETRAS(this)">
      </div>
      <div class="form-field">
        <label for="bairro">Bairro:</label>
        <input type="text" id="bairro" name="bairro">
      </div>
      <div class="form-field">
        <label for="rua">Rua:</label>
        <input type="text" id="rua" name="rua">
      </div>
      <div class="form-field">
        <label for="numero">Número:</label>
        <input type="text" id="numero" name="numero" pattern="\d{1,5}" maxlength="5" oninput="formatarNUMEROS(this)">
      </div>
      <div class="form-field">
        <label for="complemento">Complemento:</label>
        <input type="text" id="complemento" name="complemento">
      </div>
      <div class="form-field">
        <label for="outras-informacoes">Outras informações:</label>
        <input type="text" id="outras-informacoes" name="outras-informacoes"></input>
      </div>
      <div class="form-field">
        <input type="submit" value="Enviar">
      </div>
    </form>
  </div>
</body>

</html>
